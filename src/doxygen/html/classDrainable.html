<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gem5: Drainable Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Drainable Class Reference</h1><!-- doxytag: class="Drainable" -->
<p>Interface for objects that might require draining before checkpointing.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="drain_8hh_source.html">drain.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Drainable:</div>
<div class="dynsection">
 <div class="center">
  <img src="classDrainable.gif" usemap="#Drainable_map" alt=""/>
  <map id="Drainable_map" name="Drainable_map">
<area href="classBaseXBar_1_1Layer.html" alt="BaseXBar::Layer&lt; SrcType, DstType &gt;" shape="rect" coords="0,56,258,80"/>
<area href="classCopyEngine_1_1CopyEngineChannel.html" alt="CopyEngine::CopyEngineChannel" shape="rect" coords="268,56,526,80"/>
<area href="classBaseXBar_1_1Layer.html" alt="BaseXBar::Layer&lt; MasterPort, SlavePort &gt;" shape="rect" coords="536,56,794,80"/>
<area href="classBaseXBar_1_1Layer.html" alt="BaseXBar::Layer&lt; SlavePort, MasterPort &gt;" shape="rect" coords="804,56,1062,80"/>
<area href="classMSHRQueue.html" alt="MSHRQueue" shape="rect" coords="1072,56,1330,80"/>
<area href="classPacketQueue.html" alt="PacketQueue" shape="rect" coords="1340,56,1598,80"/>
<area href="classSimObject.html" alt="SimObject" shape="rect" coords="1876,56,2134,80"/>
<area href="classBaseXBar_1_1RespLayer.html" alt="BaseXBar::RespLayer" shape="rect" coords="536,112,794,136"/>
<area href="classBaseXBar_1_1ReqLayer.html" alt="BaseXBar::ReqLayer" shape="rect" coords="1072,112,1330,136"/>
<area href="classBaseXBar_1_1SnoopRespLayer.html" alt="BaseXBar::SnoopRespLayer" shape="rect" coords="1072,168,1330,192"/>
<area href="classReqPacketQueue.html" alt="ReqPacketQueue" shape="rect" coords="1608,112,1866,136"/>
<area href="classRespPacketQueue.html" alt="RespPacketQueue" shape="rect" coords="1608,168,1866,192"/>
<area href="classSnoopRespPacketQueue.html" alt="SnoopRespPacketQueue" shape="rect" coords="1608,224,1866,248"/>
<area href="classAbstractNVM.html" alt="AbstractNVM" shape="rect" coords="2144,112,2402,136"/>
<area href="classAlphaISA_1_1Interrupts.html" alt="AlphaISA::Interrupts" shape="rect" coords="2144,168,2402,192"/>
<area href="classAlphaISA_1_1ISA.html" alt="AlphaISA::ISA" shape="rect" coords="2144,224,2402,248"/>
<area href="classArmISA_1_1Interrupts.html" alt="ArmISA::Interrupts" shape="rect" coords="2144,280,2402,304"/>
<area href="structArmISA_1_1ISA.html" alt="ArmISA::ISA" shape="rect" coords="2144,336,2402,360"/>
<area href="classArmISA_1_1PMU.html" alt="ArmISA::PMU" shape="rect" coords="2144,392,2402,416"/>
<area href="classArmISA_1_1Stage2MMU.html" alt="ArmISA::Stage2MMU" shape="rect" coords="2144,448,2402,472"/>
<area href="classBaseTLB.html" alt="BaseTLB" shape="rect" coords="2144,504,2402,528"/>
<area href="classBasicLink.html" alt="BasicLink" shape="rect" coords="2144,560,2402,584"/>
<area href="classBPredUnit.html" alt="BPredUnit" shape="rect" coords="2144,616,2402,640"/>
<area href="classCacheMemory.html" alt="CacheMemory" shape="rect" coords="2144,672,2402,696"/>
<area href="classClockDomain.html" alt="ClockDomain" shape="rect" coords="2144,728,2402,752"/>
<area href="classClockedObject.html" alt="ClockedObject" shape="rect" coords="2144,784,2402,808"/>
<area href="classDirectedGenerator.html" alt="DirectedGenerator" shape="rect" coords="2144,840,2402,864"/>
<area href="classDirectoryMemory.html" alt="DirectoryMemory" shape="rect" coords="2144,896,2402,920"/>
<area href="classDiskImage.html" alt="DiskImage" shape="rect" coords="2144,952,2402,976"/>
<area href="classDVFSHandler.html" alt="DVFSHandler" shape="rect" coords="2144,1008,2402,1032"/>
<area href="classEmulatedDriver.html" alt="EmulatedDriver" shape="rect" coords="2144,1064,2402,1088"/>
<area href="classEtherDump.html" alt="EtherDump" shape="rect" coords="2144,1120,2402,1144"/>
<area href="classEtherObject.html" alt="EtherObject" shape="rect" coords="2144,1176,2402,1200"/>
<area href="classFaultModel.html" alt="FaultModel" shape="rect" coords="2144,1232,2402,1256"/>
<area href="classFUDesc.html" alt="FUDesc" shape="rect" coords="2144,1288,2402,1312"/>
<area href="classFUPool.html" alt="FUPool" shape="rect" coords="2144,1344,2402,1368"/>
<area href="classGenericTimer.html" alt="GenericTimer" shape="rect" coords="2144,1400,2402,1424"/>
<area href="classGicv2mFrame.html" alt="Gicv2mFrame" shape="rect" coords="2144,1456,2402,1480"/>
<area href="classI2CDevice.html" alt="I2CDevice" shape="rect" coords="2144,1512,2402,1536"/>
<area href="classIdeDisk.html" alt="IdeDisk" shape="rect" coords="2144,1568,2402,1592"/>
<area href="classIntrControl.html" alt="IntrControl" shape="rect" coords="2144,1624,2402,1648"/>
<area href="classKvmVM.html" alt="KvmVM" shape="rect" coords="2144,1680,2402,1704"/>
<area href="classMemChecker.html" alt="MemChecker" shape="rect" coords="2144,1736,2402,1760"/>
<area href="classMinorFU.html" alt="MinorFU" shape="rect" coords="2144,1792,2402,1816"/>
<area href="classMinorFUPool.html" alt="MinorFUPool" shape="rect" coords="2144,1848,2402,1872"/>
<area href="classMinorFUTiming.html" alt="MinorFUTiming" shape="rect" coords="2144,1904,2402,1928"/>
<area href="classMinorOpClass.html" alt="MinorOpClass" shape="rect" coords="2144,1960,2402,1984"/>
<area href="classMinorOpClassSet.html" alt="MinorOpClassSet" shape="rect" coords="2144,2016,2402,2040"/>
<area href="classMipsISA_1_1Interrupts.html" alt="MipsISA::Interrupts" shape="rect" coords="2144,2072,2402,2096"/>
<area href="classMipsISA_1_1ISA.html" alt="MipsISA::ISA" shape="rect" coords="2144,2128,2402,2152"/>
<area href="classOpDesc.html" alt="OpDesc" shape="rect" coords="2144,2184,2402,2208"/>
<area href="classPlatform.html" alt="Platform" shape="rect" coords="2144,2240,2402,2264"/>
<area href="classPowerISA_1_1Interrupts.html" alt="PowerISA::Interrupts" shape="rect" coords="2144,2296,2402,2320"/>
<area href="classPowerISA_1_1ISA.html" alt="PowerISA::ISA" shape="rect" coords="2144,2352,2402,2376"/>
<area href="classPrefetcher.html" alt="Prefetcher" shape="rect" coords="2144,2408,2402,2432"/>
<area href="classProbeListenerObject.html" alt="ProbeListenerObject" shape="rect" coords="2144,2464,2402,2488"/>
<area href="classProcess.html" alt="Process" shape="rect" coords="2144,2520,2402,2544"/>
<area href="classRoot.html" alt="Root" shape="rect" coords="2144,2576,2402,2600"/>
<area href="classSimpleDisk.html" alt="SimpleDisk" shape="rect" coords="2144,2632,2402,2656"/>
<area href="classSnoopFilter.html" alt="SnoopFilter" shape="rect" coords="2144,2688,2402,2712"/>
<area href="classSouthBridge.html" alt="SouthBridge" shape="rect" coords="2144,2744,2402,2768"/>
<area href="classSparcISA_1_1Interrupts.html" alt="SparcISA::Interrupts" shape="rect" coords="2144,2800,2402,2824"/>
<area href="classSparcISA_1_1ISA.html" alt="SparcISA::ISA" shape="rect" coords="2144,2856,2402,2880"/>
<area href="classStackDistCalc.html" alt="StackDistCalc" shape="rect" coords="2144,2912,2402,2936"/>
<area href="classSubSystem.html" alt="SubSystem" shape="rect" coords="2144,2968,2402,2992"/>
<area href="classTerminal.html" alt="Terminal" shape="rect" coords="2144,3024,2402,3048"/>
<area href="classTimingExpr.html" alt="TimingExpr" shape="rect" coords="2144,3080,2402,3104"/>
<area href="classTrace_1_1InstTracer.html" alt="Trace::InstTracer" shape="rect" coords="2144,3136,2402,3160"/>
<area href="classUFSHostDevice_1_1UFSSCSIDevice.html" alt="UFSHostDevice::UFSSCSIDevice" shape="rect" coords="2144,3192,2402,3216"/>
<area href="classVirtIODeviceBase.html" alt="VirtIODeviceBase" shape="rect" coords="2144,3248,2402,3272"/>
<area href="classVncInput.html" alt="VncInput" shape="rect" coords="2144,3304,2402,3328"/>
<area href="classVoltageDomain.html" alt="VoltageDomain" shape="rect" coords="2144,3360,2402,3384"/>
<area href="classWireBuffer.html" alt="WireBuffer" shape="rect" coords="2144,3416,2402,3440"/>
<area href="classX86ISA_1_1ACPI_1_1RSDP.html" alt="X86ISA::ACPI::RSDP" shape="rect" coords="2144,3472,2402,3496"/>
<area href="classX86ISA_1_1ACPI_1_1SysDescTable.html" alt="X86ISA::ACPI::SysDescTable" shape="rect" coords="2144,3528,2402,3552"/>
<area href="classX86ISA_1_1E820Entry.html" alt="X86ISA::E820Entry" shape="rect" coords="2144,3584,2402,3608"/>
<area href="classX86ISA_1_1E820Table.html" alt="X86ISA::E820Table" shape="rect" coords="2144,3640,2402,3664"/>
<area href="classX86ISA_1_1IntelMP_1_1BaseConfigEntry.html" alt="X86ISA::IntelMP::BaseConfigEntry" shape="rect" coords="2144,3696,2402,3720"/>
<area href="classX86ISA_1_1IntelMP_1_1ConfigTable.html" alt="X86ISA::IntelMP::ConfigTable" shape="rect" coords="2144,3752,2402,3776"/>
<area href="classX86ISA_1_1IntelMP_1_1ExtConfigEntry.html" alt="X86ISA::IntelMP::ExtConfigEntry" shape="rect" coords="2144,3808,2402,3832"/>
<area href="classX86ISA_1_1IntelMP_1_1FloatingPointer.html" alt="X86ISA::IntelMP::FloatingPointer" shape="rect" coords="2144,3864,2402,3888"/>
<area href="classX86ISA_1_1IntLine.html" alt="X86ISA::IntLine" shape="rect" coords="2144,3920,2402,3944"/>
<area href="classX86ISA_1_1IntSinkPin.html" alt="X86ISA::IntSinkPin" shape="rect" coords="2144,3976,2402,4000"/>
<area href="classX86ISA_1_1IntSourcePin.html" alt="X86ISA::IntSourcePin" shape="rect" coords="2144,4032,2402,4056"/>
<area href="classX86ISA_1_1ISA.html" alt="X86ISA::ISA" shape="rect" coords="2144,4088,2402,4112"/>
<area href="classX86ISA_1_1SMBios_1_1SMBiosStructure.html" alt="X86ISA::SMBios::SMBiosStructure" shape="rect" coords="2144,4144,2402,4168"/>
<area href="classX86ISA_1_1SMBios_1_1SMBiosTable.html" alt="X86ISA::SMBios::SMBiosTable" shape="rect" coords="2144,4200,2402,4224"/>
</map>
 </div>
</div>

<p><a href="classDrainable-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">State</a> { <a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ffa2cea28320073053047fb4cd4471b5075">Running</a>, 
<a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ffabd11bb9d2e9941029e08925c2a151162">Draining</a>, 
<a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ffad08d746efca2f68aeb28f73f94237603">Drained</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Object drain/handover states. </p>
 <a href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#ac2b5f739cc6ae6bdb563763a1f3c40f9">Drainable</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#ac41cf77f0309d150245b592d5f7c3c01">~Drainable</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#a5925c6c8b75c58fc9a50fdd9094bee22">drain</a> (<a class="el" href="classDrainManager.html">DrainManager</a> *drainManager)=0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if an object needs draining and register a <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System.">DrainManager</a>.  <a href="#a5925c6c8b75c58fc9a50fdd9094bee22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#a795e610b1a9aeadc5b4e08b9f00f8ac6">drainResume</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume execution after a successful drain.  <a href="#a795e610b1a9aeadc5b4e08b9f00f8ac6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#acf323efe6856218c6cdfde5b0ec3653d">memWriteback</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write back dirty buffers to memory using functional writes.  <a href="#acf323efe6856218c6cdfde5b0ec3653d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#aae461d54fc843a1e3570490b01e56945">memInvalidate</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Invalidate the contents of memory buffers.  <a href="#aae461d54fc843a1e3570490b01e56945"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">State</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#a0e5f525d2e1df1af3e87ce17530b40dc">getDrainState</a> () const </td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#afce7a34e1fcacc71267a947a3feb941b">setDrainState</a> (<a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">State</a> new_state)</td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">State</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainable.html#a89f25c363c2a0fcbe80f8ab493a0fbe9">_drainState</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Interface for objects that might require draining before checkpointing. </p>
<p>An object's internal state needs to be drained when creating a checkpoint, switching between CPU models, or switching between timing models. Once the internal state has been drained from <em>all</em> objects in the system, the objects are serialized to disc or the configuration change takes place. The process works as follows (see simulate.py for details):</p>
<ol>
<li>
<p class="startli">An instance of a <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System.">DrainManager</a> is created to keep track of how many objects need to be drained. The object maintains an internal counter that is decreased every time its CountedDrainEvent::signalDrainDone() method is called. When the counter reaches zero, the simulation is stopped.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Call <a class="el" href="classDrainable.html#a5925c6c8b75c58fc9a50fdd9094bee22" title="Determine if an object needs draining and register a DrainManager.">Drainable::drain()</a> for every object in the system. Draining has completed if all of them return zero. Otherwise, the sum of the return values is loaded into the counter of the <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System.">DrainManager</a>. A pointer to the drain manager is passed as an argument to the <a class="el" href="classDrainable.html#a5925c6c8b75c58fc9a50fdd9094bee22" title="Determine if an object needs draining and register a DrainManager.">drain()</a> method.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Continue simulation. When an object has finished draining its internal state, it calls CountedDrainEvent::signalDrainDone() on the manager. When the counter in the manager reaches zero, the simulation stops.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><a class="el" href="classCheck.html">Check</a> if any object still needs draining, if so repeat the process above.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Serialize objects, switch CPU model, or change timing model.</p>
<p class="endli"></p>
</li>
<li>
Call <a class="el" href="classDrainable.html#a795e610b1a9aeadc5b4e08b9f00f8ac6" title="Resume execution after a successful drain.">Drainable::drainResume()</a> and continue the simulation. </li>
</ol>

<p>Definition at line <a class="el" href="drain_8hh_source.html#l00141">141</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>
<hr/><h2>Member Enumeration Documentation</h2>
<a class="anchor" id="a6173416423af6af1bfe17262be40b5ff"></a><!-- doxytag: member="Drainable::State" ref="a6173416423af6af1bfe17262be40b5ff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">Drainable::State</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Object drain/handover states. </p>
<p>An object starts out in the Running state. When the simulator prepares to take a snapshot or prepares a CPU for handover, it calls the <a class="el" href="classDrainable.html#a5925c6c8b75c58fc9a50fdd9094bee22" title="Determine if an object needs draining and register a DrainManager.">drain()</a> method to transfer the object into the Draining or Drained state. If any object enters the Draining state (<a class="el" href="classDrainable.html#a5925c6c8b75c58fc9a50fdd9094bee22" title="Determine if an object needs draining and register a DrainManager.">drain()</a> returning &gt;0), simulation continues until it all objects have entered the Drained state.</p>
<p>Before resuming simulation, the simulator calls resume() to transfer the object to the Running state.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Even though the state of an object (visible to the rest of the world through getState()) could be used to determine if all objects have entered the Drained state, the protocol is actually a bit more elaborate. See <a class="el" href="classDrainable.html#a5925c6c8b75c58fc9a50fdd9094bee22" title="Determine if an object needs draining and register a DrainManager.">drain()</a> for details. </dd></dl>
<dl><dt><b>Enumerator: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a6173416423af6af1bfe17262be40b5ffa2cea28320073053047fb4cd4471b5075"></a><!-- doxytag: member="Running" ref="a6173416423af6af1bfe17262be40b5ffa2cea28320073053047fb4cd4471b5075" args="" -->Running</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a6173416423af6af1bfe17262be40b5ffabd11bb9d2e9941029e08925c2a151162"></a><!-- doxytag: member="Draining" ref="a6173416423af6af1bfe17262be40b5ffabd11bb9d2e9941029e08925c2a151162" args="" -->Draining</em>&nbsp;</td><td>
<p>Running normally. </p>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a6173416423af6af1bfe17262be40b5ffad08d746efca2f68aeb28f73f94237603"></a><!-- doxytag: member="Drained" ref="a6173416423af6af1bfe17262be40b5ffad08d746efca2f68aeb28f73f94237603" args="" -->Drained</em>&nbsp;</td><td>
<p>Draining buffers pending serialization/handover. </p>
<p>Buffers drained, ready for serialization/handover </p>
</td></tr>
</table>
</dd>
</dl>

<p>Reimplemented in <a class="el" href="classBaseXBar_1_1Layer.html#ad8d693fc2d8f687b84ae40257f6ad853">BaseXBar::Layer&lt; SrcType, DstType &gt;</a>, <a class="el" href="classVGic.html#ac6a7408e02e8e31239872a430a00a649">VGic</a>, <a class="el" href="classBaseXBar_1_1Layer.html#ad8d693fc2d8f687b84ae40257f6ad853">BaseXBar::Layer&lt; SlavePort, MasterPort &gt;</a>, and <a class="el" href="classBaseXBar_1_1Layer.html#ad8d693fc2d8f687b84ae40257f6ad853">BaseXBar::Layer&lt; MasterPort, SlavePort &gt;</a>.</p>

<p>Definition at line <a class="el" href="drain_8hh_source.html#l00162">162</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ac2b5f739cc6ae6bdb563763a1f3c40f9"></a><!-- doxytag: member="Drainable::Drainable" ref="ac2b5f739cc6ae6bdb563763a1f3c40f9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Drainable::Drainable </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="drain_8cc_source.html#l00060">60</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ac41cf77f0309d150245b592d5f7c3c01"></a><!-- doxytag: member="Drainable::~Drainable" ref="ac41cf77f0309d150245b592d5f7c3c01" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Drainable::~Drainable </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="drain_8cc_source.html#l00065">65</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a5925c6c8b75c58fc9a50fdd9094bee22"></a><!-- doxytag: member="Drainable::drain" ref="a5925c6c8b75c58fc9a50fdd9094bee22" args="(DrainManager *drainManager)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual unsigned int Drainable::drain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainManager.html">DrainManager</a> *&nbsp;</td>
          <td class="paramname"> <em>drainManager</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine if an object needs draining and register a <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System.">DrainManager</a>. </p>
<p>When draining the state of an object, the simulator calls drain with a pointer to a drain manager. If the object does not need further simulation to drain internal buffers, it switched to the Drained state and returns 0, otherwise it switches to the Draining state and returns the number of times that it will call <a class="el" href="classEvent.html#af1940e82c4da67c8119f0dfe026949b4">Event::process()</a> on the drain event. Most objects are expected to return either 0 or 1.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>An object that has entered the Drained state can be disturbed by other objects in the system and consequently be forced to enter the Draining state again. The simulator therefore repeats the draining process until all objects return 0 on the first call to <a class="el" href="classDrainable.html#a5925c6c8b75c58fc9a50fdd9094bee22" title="Determine if an object needs draining and register a DrainManager.">drain()</a>.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>drainManager</em>&nbsp;</td><td><a class="el" href="classDrainManager.html" title="This class coordinates draining of a System.">DrainManager</a> to use to inform the simulator when draining has completed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if the object is ready for serialization now, &gt;0 if it needs further simulation. </dd></dl>

<p>Implemented in <a class="el" href="classArmISA_1_1Stage2MMU.html#a4775c480997b210429e48facc94b6f97">ArmISA::Stage2MMU</a>, <a class="el" href="classArmISA_1_1TableWalker.html#a27f379100b5713f9ccc49b3680dcc68f">ArmISA::TableWalker</a>, <a class="el" href="classTrafficGen.html#a558bbee61db5e73745a59654e46e74dd">TrafficGen</a>, <a class="el" href="classFlashDevice.html#ac97d52df7a029be220a7cc46d6df2ad3">FlashDevice</a>, <a class="el" href="classUFSHostDevice.html#aa682ec081f300a366492687287dfdfa7">UFSHostDevice</a>, <a class="el" href="classCopyEngine_1_1CopyEngineChannel.html#ad5a3eed0b985e2727979854a3e69bb67">CopyEngine::CopyEngineChannel</a>, <a class="el" href="classCopyEngine.html#a8c0f4e530b58aa78453da31f38924651">CopyEngine</a>, <a class="el" href="classDmaDevice.html#a4a7db14b0ca2251d3bcf65e3f858990e">DmaDevice</a>, <a class="el" href="classIGbE.html#a2aa8408dbfac4edf8f56de38c8be9067">IGbE</a>, <a class="el" href="classPioDevice.html#aad86b785c0dca25037d8bb6dbab3969d">PioDevice</a>, <a class="el" href="classPciDevice.html#ac2afbeba87aeab6251ba3445eef21423">PciDevice</a>, <a class="el" href="classBaseCache.html#a6b1f53bfd0cba2dea923811773e15ff7">BaseCache</a>, <a class="el" href="classMSHRQueue.html#ab16b2e79737a49c1704a48ab963b8484">MSHRQueue</a>, <a class="el" href="classCoherentXBar.html#af7e70111e63a00e474d37f4ad0ef1fb8">CoherentXBar</a>, <a class="el" href="classDRAMCtrl.html#aa0beabe573e2af900736ec24bbc33bf4">DRAMCtrl</a>, <a class="el" href="classDRAMSim2.html#a28a5cfdf1de57b407fea9bb158217fbb">DRAMSim2</a>, <a class="el" href="classNoncoherentXBar.html#a93834b33f6f9bf20baab96538599222d">NoncoherentXBar</a>, <a class="el" href="classPacketQueue.html#ab5edfcd848424a9a1cc8d5df81377abb">PacketQueue</a>, <a class="el" href="classRubyMemoryControl.html#a1971e103df986a0364d356618757b4e2">RubyMemoryControl</a>, <a class="el" href="classDMASequencer.html#aa002a4be927f891bb97634f58d10c54c">DMASequencer</a>, <a class="el" href="classRubyPort.html#a59b39e0405385eac452868fe8640712f">RubyPort</a>, <a class="el" href="classSimpleMemory.html#a1a1dfba106ab08e05781cbe7a38089f3">SimpleMemory</a>, <a class="el" href="classBaseXBar_1_1Layer.html#afab7dfff672af6ab477c8da80b60742b">BaseXBar::Layer&lt; SrcType, DstType &gt;</a>, <a class="el" href="classBaseXBar.html#a70c8eca940cb7b30eb5e9d5efa646e12">BaseXBar</a>, <a class="el" href="classSimObject.html#a2f35c3af76edda938cf66ceda6e08047">SimObject</a>, <a class="el" href="classSystem.html#a3e2ed8f22fb7ba5a4e672ef8ce14ac32">System</a>, <a class="el" href="classBaseXBar_1_1Layer.html#afab7dfff672af6ab477c8da80b60742b">BaseXBar::Layer&lt; SlavePort, MasterPort &gt;</a>, and <a class="el" href="classBaseXBar_1_1Layer.html#afab7dfff672af6ab477c8da80b60742b">BaseXBar::Layer&lt; MasterPort, SlavePort &gt;</a>.</p>

</div>
</div>
<a class="anchor" id="a795e610b1a9aeadc5b4e08b9f00f8ac6"></a><!-- doxytag: member="Drainable::drainResume" ref="a795e610b1a9aeadc5b4e08b9f00f8ac6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Drainable::drainResume </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resume execution after a successful drain. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>This method is normally only called from the simulation scripts. </dd></dl>

<p>Reimplemented in <a class="el" href="classKvmGic.html#a7d8f1708755dfad6d6e14e20395c2f1c">KvmGic</a>, <a class="el" href="classArmISA_1_1PMU.html#aaf2fe7e83b180537173c7dbd344e00bb">ArmISA::PMU</a>, <a class="el" href="classArmISA_1_1TableWalker.html#adcb443adaf08ad0f617d82ea1cfb7b13">ArmISA::TableWalker</a>, <a class="el" href="classArmISA_1_1TLB.html#a376793db82a8d4070f96059e0f41bce2">ArmISA::TLB</a>, <a class="el" href="classCopyEngine_1_1CopyEngineChannel.html#af1aaf7bceb9c10cc4ce2885c3cea7f03">CopyEngine::CopyEngineChannel</a>, <a class="el" href="classCopyEngine.html#a744b1240c57fb395108814a4097d9f48">CopyEngine</a>, <a class="el" href="classIGbE.html#a85d1d431bf829ddc4232c0d95bf5744d">IGbE</a>, <a class="el" href="classNSGigE.html#aa964a077971a24053b3c187594c30cb6">NSGigE</a>, <a class="el" href="classSinic_1_1Device.html#ab7002d56b84b46b1f20a682c4a1159d1">Sinic::Device</a>, <a class="el" href="classDRAMCtrl.html#a23076dc0bfa8851eca587d148fcefe06">DRAMCtrl</a>, and <a class="el" href="classSystem.html#a389cad4b21dd4288aff3f547c5929448">System</a>.</p>

<p>Definition at line <a class="el" href="drain_8cc_source.html#l00070">70</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p>References <a class="el" href="drain_8hh_source.html#l00235">_drainState</a>, and <a class="el" href="drain_8hh_source.html#l00163">Running</a>.</p>

<p>Referenced by <a class="el" href="cxx__manager_8cc_source.html#l00658">CxxConfigManager::drainResume()</a>.</p>

</div>
</div>
<a class="anchor" id="a0e5f525d2e1df1af3e87ce17530b40dc"></a><!-- doxytag: member="Drainable::getDrainState" ref="a0e5f525d2e1df1af3e87ce17530b40dc" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">State</a> Drainable::getDrainState </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="drain_8hh_source.html#l00228">228</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p>References <a class="el" href="drain_8hh_source.html#l00235">_drainState</a>.</p>

<p>Referenced by <a class="el" href="ide__disk_8cc_source.html#l00421">IdeDisk::doDmaRead()</a>, <a class="el" href="ide__disk_8cc_source.html#l00333">IdeDisk::doDmaTransfer()</a>, <a class="el" href="ide__disk_8cc_source.html#l00506">IdeDisk::doDmaWrite()</a>, <a class="el" href="ns__gige_8cc_source.html#l01066">NSGigE::doRxDmaRead()</a>, <a class="el" href="ns__gige_8cc_source.html#l01097">NSGigE::doRxDmaWrite()</a>, <a class="el" href="ns__gige_8cc_source.html#l01513">NSGigE::doTxDmaRead()</a>, <a class="el" href="ns__gige_8cc_source.html#l01544">NSGigE::doTxDmaWrite()</a>, <a class="el" href="copy__engine_8cc_source.html#l00649">CopyEngine::CopyEngineChannel::drain()</a>, <a class="el" href="i8254xGBe_8hh_source.html#l00415">IGbE::TxDescCache::fetchAfterWb()</a>, <a class="el" href="i8254xGBe_8hh_source.html#l00353">IGbE::RxDescCache::fetchAfterWb()</a>, <a class="el" href="i8254xGBe_8cc_source.html#l00986">IGbE::DescCache&lt; T &gt;::fetchDescriptors1()</a>, <a class="el" href="copy__engine_8cc_source.html#l00636">CopyEngine::CopyEngineChannel::inDrain()</a>, <a class="el" href="Sequencer_8cc_source.html#l00211">Sequencer::insertRequest()</a>, <a class="el" href="copy__engine_8cc_source.html#l00136">CopyEngine::CopyEngineChannel::recvCommand()</a>, <a class="el" href="i8254xGBe_8cc_source.html#l02049">IGbE::restartClock()</a>, <a class="el" href="sinic_8cc_source.html#l00716">Sinic::Device::rxKick()</a>, <a class="el" href="sim_2system_8cc_source.html#l00192">System::setMemoryMode()</a>, <a class="el" href="sinic_8cc_source.html#l01033">Sinic::Device::txKick()</a>, <a class="el" href="Sequencer_8cc_source.html#l00078">Sequencer::wakeup()</a>, <a class="el" href="i8254xGBe_8cc_source.html#l00356">IGbE::write()</a>, and <a class="el" href="i8254xGBe_8cc_source.html#l00905">IGbE::DescCache&lt; T &gt;::writeback1()</a>.</p>

</div>
</div>
<a class="anchor" id="aae461d54fc843a1e3570490b01e56945"></a><!-- doxytag: member="Drainable::memInvalidate" ref="aae461d54fc843a1e3570490b01e56945" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Drainable::memInvalidate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Invalidate the contents of memory buffers. </p>
<p>When the switching to hardware virtualized CPU models, we need to make sure that we don't have any cached state in the system that might become stale when we return. This method is used to flush all such state back to main memory.</p>
<p>This does <em>not</em> cause any dirty state to be written back to memory. </p>

<p>Reimplemented in <a class="el" href="classBaseTLB.html#a92b6a822a2aa73cbd050cc6b05eed107">BaseTLB</a>, <a class="el" href="classBaseCache.html#a576c813c988e11a183fc2f018a2aebcb">BaseCache</a>, and <a class="el" href="classCache.html#a8b62677234d5ec418aa841db27d40f42">Cache</a>.</p>

<p>Definition at line <a class="el" href="drain_8hh_source.html#l00226">226</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

</div>
</div>
<a class="anchor" id="acf323efe6856218c6cdfde5b0ec3653d"></a><!-- doxytag: member="Drainable::memWriteback" ref="acf323efe6856218c6cdfde5b0ec3653d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void Drainable::memWriteback </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write back dirty buffers to memory using functional writes. </p>
<p>After returning, an object implementing this method should have written all its dirty data back to memory. This method is typically used to prepare a system with caches for checkpointing. </p>

<p>Reimplemented in <a class="el" href="classBaseCache.html#a44da9a76d76a82080868276b382fadfa">BaseCache</a>, and <a class="el" href="classCache.html#a3a7464d3e539882729133f1408f9b3b8">Cache</a>.</p>

<p>Definition at line <a class="el" href="drain_8hh_source.html#l00213">213</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

</div>
</div>
<a class="anchor" id="afce7a34e1fcacc71267a947a3feb941b"></a><!-- doxytag: member="Drainable::setDrainState" ref="afce7a34e1fcacc71267a947a3feb941b" args="(State new_state)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Drainable::setDrainState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">State</a>&nbsp;</td>
          <td class="paramname"> <em>new_state</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="drain_8hh_source.html#l00231">231</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p>References <a class="el" href="drain_8hh_source.html#l00235">_drainState</a>.</p>

<p>Referenced by <a class="el" href="table__walker_8cc_source.html#l00138">ArmISA::TableWalker::completeDrain()</a>, <a class="el" href="mshr__queue_8cc_source.html#l00172">MSHRQueue::deallocateOne()</a>, <a class="el" href="sim__object_8cc_source.html#l00181">SimObject::drain()</a>, <a class="el" href="simple__mem_8cc_source.html#l00237">SimpleMemory::drain()</a>, <a class="el" href="RubyPort_8cc_source.html#l00428">RubyPort::drain()</a>, <a class="el" href="DMASequencer_8cc_source.html#l00173">DMASequencer::drain()</a>, <a class="el" href="dramsim2_8cc_source.html#l00363">DRAMSim2::drain()</a>, <a class="el" href="dram__ctrl_8cc_source.html#l02195">DRAMCtrl::drain()</a>, <a class="el" href="mshr__queue_8cc_source.html#l00269">MSHRQueue::drain()</a>, <a class="el" href="pcidev_8cc_source.html#l00259">PciDevice::drain()</a>, <a class="el" href="io__device_8cc_source.html#l00097">PioDevice::drain()</a>, <a class="el" href="i8254xGBe_8cc_source.html#l02057">IGbE::drain()</a>, <a class="el" href="dma__device_8cc_source.html#l00129">DmaDevice::drain()</a>, <a class="el" href="copy__engine_8cc_source.html#l00662">CopyEngine::drain()</a>, <a class="el" href="ufs__device_8cc_source.html#l02320">UFSHostDevice::drain()</a>, <a class="el" href="flash__device_8cc_source.html#l00591">FlashDevice::drain()</a>, <a class="el" href="mem_2cache_2base_8cc_source.html#l00778">BaseCache::drain()</a>, <a class="el" href="table__walker_8cc_source.html#l00150">ArmISA::TableWalker::drain()</a>, and <a class="el" href="sim_2system_8cc_source.html#l00359">System::drain()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a89f25c363c2a0fcbe80f8ab493a0fbe9"></a><!-- doxytag: member="Drainable::_drainState" ref="a89f25c363c2a0fcbe80f8ab493a0fbe9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDrainable.html#a6173416423af6af1bfe17262be40b5ff">State</a> <a class="el" href="classDrainable.html#a89f25c363c2a0fcbe80f8ab493a0fbe9">Drainable::_drainState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="drain_8hh_source.html#l00235">235</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p>Referenced by <a class="el" href="drain_8cc_source.html#l00070">drainResume()</a>, <a class="el" href="drain_8hh_source.html#l00228">getDrainState()</a>, and <a class="el" href="drain_8hh_source.html#l00231">setDrainState()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sim/<a class="el" href="drain_8hh_source.html">drain.hh</a></li>
<li>sim/<a class="el" href="drain_8cc_source.html">drain.cc</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"><address style="align: right;"><small>
Generated on Mon Dec 7 02:33:19 2015 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.6.1</small></address>

</body>
</html>
