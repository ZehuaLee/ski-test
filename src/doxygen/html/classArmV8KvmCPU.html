<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gem5: ArmV8KvmCPU Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ArmV8KvmCPU Class Reference</h1><!-- doxytag: class="ArmV8KvmCPU" --><!-- doxytag: inherits="BaseArmKvmCPU" -->
<p>This is an implementation of a KVM-based ARMv8-compatible CPU.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="armv8__cpu_8hh_source.html">armv8_cpu.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ArmV8KvmCPU:</div>
<div class="dynsection">
 <div class="center">
  <img src="classArmV8KvmCPU.gif" usemap="#ArmV8KvmCPU_map" alt=""/>
  <map id="ArmV8KvmCPU_map" name="ArmV8KvmCPU_map">
<area href="classBaseArmKvmCPU.html" alt="BaseArmKvmCPU" shape="rect" coords="0,112,112,136"/>
<area href="classBaseKvmCPU.html" alt="BaseKvmCPU" shape="rect" coords="0,56,112,80"/>
<area href="classBaseCPU.html" alt="BaseCPU" shape="rect" coords="0,0,112,24"/>
</map>
 </div>
</div>

<p><a href="classArmV8KvmCPU-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structArmV8KvmCPU_1_1IntRegInfo.html">IntRegInfo</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping between integer registers in gem5 and KVM.  <a href="structArmV8KvmCPU_1_1IntRegInfo.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structArmV8KvmCPU_1_1MiscRegInfo.html">MiscRegInfo</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping between misc registers in gem5 and registers in KVM.  <a href="structArmV8KvmCPU_1_1MiscRegInfo.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#a09126d3e5985281f3f96eaeeb69bc329">ArmV8KvmCPU</a> (ArmV8KvmCPUParams *params)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#a05e821a52905ea2158b43e6286882722">~ArmV8KvmCPU</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#a2938f217fc7f8ac55515d07440d0b99e">dump</a> () M5_ATTR_OVERRIDE</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump the internal state to the terminal.  <a href="#a2938f217fc7f8ac55515d07440d0b99e"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#aceb73c045ccd95c5f651a4fbc5957ce2">updateKvmState</a> () M5_ATTR_OVERRIDE</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the KVM state from the current thread context.  <a href="#aceb73c045ccd95c5f651a4fbc5957ce2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#a13ac7e75d2ca44b73861ca2170115747">updateThreadContext</a> () M5_ATTR_OVERRIDE</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the current thread context with the KVM state.  <a href="#a13ac7e75d2ca44b73861ca2170115747"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classstd_1_1vector.html">std::vector</a><br class="typebreak"/>
&lt; <a class="el" href="structArmV8KvmCPU_1_1MiscRegInfo.html">ArmV8KvmCPU::MiscRegInfo</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#afa13cd1d32a5b92717bf153c5155e038">getSysRegMap</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a map between system registers in kvm and gem5 registers.  <a href="#afa13cd1d32a5b92717bf153c5155e038"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a><br class="typebreak"/>
&lt; <a class="el" href="structArmV8KvmCPU_1_1MiscRegInfo.html">ArmV8KvmCPU::MiscRegInfo</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#a43da0e4a006bce52aa054bacea2b4242">sysRegMap</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cached mapping between system registers in kvm and misc regs in gem5.  <a href="#a43da0e4a006bce52aa054bacea2b4242"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classstd_1_1vector.html">std::vector</a><br class="typebreak"/>
&lt; <a class="el" href="structArmV8KvmCPU_1_1IntRegInfo.html">ArmV8KvmCPU::IntRegInfo</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#a404b8196ba61a8398f3c660af97c977c">intRegMap</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping between gem5 integer registers and integer registers in kvm.  <a href="#a404b8196ba61a8398f3c660af97c977c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classstd_1_1vector.html">std::vector</a><br class="typebreak"/>
&lt; <a class="el" href="structArmV8KvmCPU_1_1MiscRegInfo.html">ArmV8KvmCPU::MiscRegInfo</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmV8KvmCPU.html#a2ad7971fa046d7bb623529fa481bc065">miscRegMap</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mapping between gem5 misc registers registers and registers in kvm.  <a href="#a2ad7971fa046d7bb623529fa481bc065"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This is an implementation of a KVM-based ARMv8-compatible CPU. </p>
<p>Known limitations: </p>
<ul>
<li>
<p class="startli">The system-register-based generic timer can only be simulated by the host kernel. Workaround: Use a memory mapped timer instead to simulate the timer in gem5.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Simulating devices (e.g., the generic timer) in the host kernel requires that the host kernel also simulates the GIC.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">ID registers in the host and in gem5 must match for switching between simulated CPUs and KVM. This is particularly important for ID registers describing memory system capabilities (e.g., ASID size, physical address size).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Switching between a virtualized CPU and a simulated CPU is currently not supported if in-kernel device emulation is used. This could be worked around by adding support for switching to the gem5 (e.g., the <a class="el" href="classKvmGic.html" title="In-kernel GIC model.">KvmGic</a>) side of the device models. A simpler workaround is to avoid in-kernel device models altogether.</p>
<p class="endli"></p>
</li>
</ul>

<p>Definition at line <a class="el" href="armv8__cpu_8hh_source.html#l00080">80</a> of file <a class="el" href="armv8__cpu_8hh_source.html">armv8_cpu.hh</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a09126d3e5985281f3f96eaeeb69bc329"></a><!-- doxytag: member="ArmV8KvmCPU::ArmV8KvmCPU" ref="a09126d3e5985281f3f96eaeeb69bc329" args="(ArmV8KvmCPUParams *params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ArmV8KvmCPU::ArmV8KvmCPU </td>
          <td>(</td>
          <td class="paramtype">ArmV8KvmCPUParams *&nbsp;</td>
          <td class="paramname"> <em>params</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="armv8__cpu_8cc_source.html#l00116">116</a> of file <a class="el" href="armv8__cpu_8cc_source.html">armv8_cpu.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a05e821a52905ea2158b43e6286882722"></a><!-- doxytag: member="ArmV8KvmCPU::~ArmV8KvmCPU" ref="a05e821a52905ea2158b43e6286882722" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ArmV8KvmCPU::~ArmV8KvmCPU </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="armv8__cpu_8cc_source.html#l00121">121</a> of file <a class="el" href="armv8__cpu_8cc_source.html">armv8_cpu.cc</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a2938f217fc7f8ac55515d07440d0b99e"></a><!-- doxytag: member="ArmV8KvmCPU::dump" ref="a2938f217fc7f8ac55515d07440d0b99e" args="() M5_ATTR_OVERRIDE" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ArmV8KvmCPU::dump </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dump the internal state to the terminal. </p>

<p>Reimplemented from <a class="el" href="classBaseKvmCPU.html#a42ddb8b4785004b7fa2f9970f1ca2a4d">BaseKvmCPU</a>.</p>

<p>Definition at line <a class="el" href="armv8__cpu_8cc_source.html#l00126">126</a> of file <a class="el" href="armv8__cpu_8cc_source.html">armv8_cpu.cc</a>.</p>

<p>References <a class="el" href="namespaceArmISA.html#aa997a57492cbf2204c7b0ec435873edb">ArmISA::decodeAArch64SysReg()</a>, <a class="el" href="arm__cpu_8cc_source.html#l00057">EXTRACT_FIELD</a>, <a class="el" href="cpu_2kvm_2base_8cc_source.html#l00813">BaseKvmCPU::getAndFormatOneReg()</a>, <a class="el" href="base__cpu_8cc_source.html#l00107">BaseArmKvmCPU::getRegList()</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l01377">ArmISA::i</a>, <a class="el" href="sparc_2miscregs_8hh_source.html#l00124">SparcISA::id</a>, <a class="el" href="base_2misc_8hh_source.html#l00209">inform</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00065">INT_REG</a>, <a class="el" href="armv8__cpu_8hh_source.html#l00132">intRegMap</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00076">kvmFPReg()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00069">kvmXReg()</a>, <a class="el" href="armv8__cpu_8hh_source.html#l00134">miscRegMap</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00738">ArmISA::miscRegName</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00054">NUM_QREGS</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00049">NUM_XREGS</a>, <a class="el" href="arch_2x86_2types_8hh_source.html#l00087">X86ISA::reg</a>, <a class="el" href="arch_2x86_2regs_2misc_8hh_source.html#l00719">X86ISA::type</a>, and <a class="el" href="arch_2x86_2regs_2misc_8hh_source.html#l00761">X86ISA::val</a>.</p>

</div>
</div>
<a class="anchor" id="afa13cd1d32a5b92717bf153c5155e038"></a><!-- doxytag: member="ArmV8KvmCPU::getSysRegMap" ref="afa13cd1d32a5b92717bf153c5155e038" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="structArmV8KvmCPU_1_1MiscRegInfo.html">ArmV8KvmCPU::MiscRegInfo</a> &gt; &amp; ArmV8KvmCPU::getSysRegMap </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a map between system registers in kvm and gem5 registers. </p>
<p>This method returns a mapping between system registers in kvm and misc regs in gem5. The actual mapping is only created the first time the method is called and stored in a cache (<a class="el" href="classArmV8KvmCPU.html#a43da0e4a006bce52aa054bacea2b4242" title="Cached mapping between system registers in kvm and misc regs in gem5.">ArmV8KvmCPU::sysRegMap</a>).</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Vector of kvm&lt;-&gt;misc reg mappings. </dd></dl>

<p>Definition at line <a class="el" href="armv8__cpu_8cc_source.html#l00283">283</a> of file <a class="el" href="armv8__cpu_8cc_source.html">armv8_cpu.cc</a>.</p>

<p>References <a class="el" href="namespaceArmISA.html#aa997a57492cbf2204c7b0ec435873edb">ArmISA::decodeAArch64SysReg()</a>, <a class="el" href="arm__cpu_8cc_source.html#l00057">EXTRACT_FIELD</a>, <a class="el" href="base__cpu_8cc_source.html#l00107">BaseArmKvmCPU::getRegList()</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00708">ArmISA::MISCREG_HYP_WR</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00680">ArmISA::MISCREG_IMPLEMENTED</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00711">ArmISA::MISCREG_MON_NS0_WR</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00714">ArmISA::MISCREG_MON_NS1_WR</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00703">ArmISA::MISCREG_PRI_NS_WR</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00705">ArmISA::MISCREG_PRI_S_WR</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00698">ArmISA::MISCREG_USR_NS_WR</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00700">ArmISA::MISCREG_USR_S_WR</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00683">ArmISA::MISCREG_WARN_NOT_FAIL</a>, <a class="el" href="miscregs_8cc_source.html#l00128">ArmISA::miscRegInfo</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00738">ArmISA::miscRegName</a>, <a class="el" href="arch_2x86_2types_8hh_source.html#l00087">X86ISA::reg</a>, <a class="el" href="armv8__cpu_8hh_source.html#l00137">sysRegMap</a>, and <a class="el" href="arch_2x86_2regs_2misc_8hh_source.html#l00719">X86ISA::type</a>.</p>

<p>Referenced by <a class="el" href="armv8__cpu_8cc_source.html#l00188">updateKvmState()</a>, and <a class="el" href="armv8__cpu_8cc_source.html#l00230">updateThreadContext()</a>.</p>

</div>
</div>
<a class="anchor" id="aceb73c045ccd95c5f651a4fbc5957ce2"></a><!-- doxytag: member="ArmV8KvmCPU::updateKvmState" ref="aceb73c045ccd95c5f651a4fbc5957ce2" args="() M5_ATTR_OVERRIDE" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ArmV8KvmCPU::updateKvmState </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the KVM state from the current thread context. </p>
<p>The base CPU calls this method before starting the guest CPU when the contextDirty flag is set. The architecture dependent CPU implementation is expected to update all guest state (registers, special registers, and FPU state). </p>

<p>Implements <a class="el" href="classBaseKvmCPU.html#a74c51072421abe73972e1085f45f5f8b">BaseKvmCPU</a>.</p>

<p>Definition at line <a class="el" href="armv8__cpu_8cc_source.html#l00188">188</a> of file <a class="el" href="armv8__cpu_8cc_source.html">armv8_cpu.cc</a>.</p>

<p>References <a class="el" href="armv8__cpu_8cc_source.html#l00093">KvmFPReg::data</a>, <a class="el" href="base_2trace_8hh_source.html#l00211">DPRINTF</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00096">FP_REGS_PER_VFP_REG</a>, <a class="el" href="cpu_2kvm_2base_8cc_source.html#l00813">BaseKvmCPU::getAndFormatOneReg()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00283">getSysRegMap()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00084">KvmFPReg::i</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l01377">ArmISA::i</a>, <a class="el" href="classThreadContext.html#a78ae75b2c7b52b090ea58d8aafaae452">ThreadContext::instAddr()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00065">INT_REG</a>, <a class="el" href="intregs_8hh_source.html#l00129">ArmISA::INTREG_X0</a>, <a class="el" href="armv8__cpu_8hh_source.html#l00132">intRegMap</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l01368">ArmISA::j</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00076">kvmFPReg()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00069">kvmXReg()</a>, <a class="el" href="armv8__cpu_8hh_source.html#l00134">miscRegMap</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00054">NUM_QREGS</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00049">NUM_XREGS</a>, <a class="el" href="classThreadContext.html#a6a8c24030c5ca6030a3d2aacf17b171d">ThreadContext::readFloatRegBits()</a>, <a class="el" href="classThreadContext.html#a328471149b318afecfe5b52d9696bfdc">ThreadContext::readIntReg()</a>, <a class="el" href="classThreadContext.html#a49de25575586f1e9bb3c72c2c4178c72">ThreadContext::readMiscReg()</a>, <a class="el" href="arch_2x86_2types_8hh_source.html#l00087">X86ISA::reg</a>, <a class="el" href="unionKvmFPReg.html#a29840942d4f1ea0e61b07346dbba259b">KvmFPReg::s</a>, <a class="el" href="cpu_2kvm_2base_8cc_source.html#l00779">BaseKvmCPU::setOneReg()</a>, and <a class="el" href="cpu_2kvm_2base_8hh_source.html#l00142">BaseKvmCPU::tc</a>.</p>

</div>
</div>
<a class="anchor" id="a13ac7e75d2ca44b73861ca2170115747"></a><!-- doxytag: member="ArmV8KvmCPU::updateThreadContext" ref="a13ac7e75d2ca44b73861ca2170115747" args="() M5_ATTR_OVERRIDE" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ArmV8KvmCPU::updateThreadContext </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the current thread context with the KVM state. </p>
<p>The base CPU after the guest updates any of the KVM state. In practice, this happens after kvmRun is called. The architecture dependent code is expected to read the state of the guest CPU and update gem5's thread state. </p>

<p>Implements <a class="el" href="classBaseKvmCPU.html#ac943446adae87cc8b93f9adc9ce26158">BaseKvmCPU</a>.</p>

<p>Definition at line <a class="el" href="armv8__cpu_8cc_source.html#l00230">230</a> of file <a class="el" href="armv8__cpu_8cc_source.html">armv8_cpu.cc</a>.</p>

<p>References <a class="el" href="arm_2miscregs_8hh_source.html#l01848">ArmISA::cpsr</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00093">KvmFPReg::data</a>, <a class="el" href="base_2trace_8hh_source.html#l00211">DPRINTF</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00096">FP_REGS_PER_VFP_REG</a>, <a class="el" href="cpu_2kvm_2base_8cc_source.html#l00813">BaseKvmCPU::getAndFormatOneReg()</a>, <a class="el" href="cpu_2kvm_2base_8cc_source.html#l00796">BaseKvmCPU::getOneReg()</a>, <a class="el" href="cpu_2kvm_2base_8hh_source.html#l00352">BaseKvmCPU::getOneRegU64()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00283">getSysRegMap()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00084">KvmFPReg::i</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l01377">ArmISA::i</a>, <a class="el" href="namespaceArmISA.html#a24a144e8bb48dfc6573d7027cafd199b">ArmISA::inAArch64()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00065">INT_REG</a>, <a class="el" href="intregs_8hh_source.html#l00129">ArmISA::INTREG_X0</a>, <a class="el" href="armv8__cpu_8hh_source.html#l00132">intRegMap</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l01368">ArmISA::j</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00076">kvmFPReg()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00069">kvmXReg()</a>, <a class="el" href="arm_2miscregs_8hh_source.html#l00057">ArmISA::MISCREG_CPSR</a>, <a class="el" href="armv8__cpu_8hh_source.html#l00134">miscRegMap</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00054">NUM_QREGS</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00049">NUM_XREGS</a>, <a class="el" href="pra__constants_8hh_source.html#l00242">MipsISA::pc</a>, <a class="el" href="classThreadContext.html#ab15f0db0e7c7afb40dfbbbd13d62dc2e">ThreadContext::pcState()</a>, <a class="el" href="classThreadContext.html#ab3e3af9cdb680faad903612b9733d068">ThreadContext::readMiscRegNoEffect()</a>, <a class="el" href="arch_2x86_2types_8hh_source.html#l00087">X86ISA::reg</a>, <a class="el" href="unionKvmFPReg.html#a29840942d4f1ea0e61b07346dbba259b">KvmFPReg::s</a>, <a class="el" href="classThreadContext.html#a6cfd6de3e1524055c4df2c2cf46832ca">ThreadContext::setFloatRegBits()</a>, <a class="el" href="classThreadContext.html#ad008e016fd7ac09d11a85a80aa917b41">ThreadContext::setIntReg()</a>, <a class="el" href="classThreadContext.html#a50d110467c213c1caec6ff304fc44521">ThreadContext::setMiscRegNoEffect()</a>, and <a class="el" href="cpu_2kvm_2base_8hh_source.html#l00142">BaseKvmCPU::tc</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a404b8196ba61a8398f3c660af97c977c"></a><!-- doxytag: member="ArmV8KvmCPU::intRegMap" ref="a404b8196ba61a8398f3c660af97c977c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="structArmV8KvmCPU_1_1IntRegInfo.html">ArmV8KvmCPU::IntRegInfo</a> &gt; <a class="el" href="classArmV8KvmCPU.html#a404b8196ba61a8398f3c660af97c977c">ArmV8KvmCPU::intRegMap</a><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    { <a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(regs.sp), <a class="code" href="namespaceArmISA.html#a28f9c55fc1ae496fd36bca4b09be4a5fa21fa949889362c27926c1965bb2073aa">INTREG_SP0</a>, <span class="stringliteral">&quot;SP(EL0)&quot;</span> },
    { <a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(sp_el1), <a class="code" href="namespaceArmISA.html#a28f9c55fc1ae496fd36bca4b09be4a5faebb0b7237f827c636a9b4dcb78697c51">INTREG_SP1</a>, <span class="stringliteral">&quot;SP(EL1)&quot;</span> },
}
</pre></div>
<p>Mapping between gem5 integer registers and integer registers in kvm. </p>

<p>Definition at line <a class="el" href="armv8__cpu_8hh_source.html#l00132">132</a> of file <a class="el" href="armv8__cpu_8hh_source.html">armv8_cpu.hh</a>.</p>

<p>Referenced by <a class="el" href="armv8__cpu_8cc_source.html#l00126">dump()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00188">updateKvmState()</a>, and <a class="el" href="armv8__cpu_8cc_source.html#l00230">updateThreadContext()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ad7971fa046d7bb623529fa481bc065"></a><!-- doxytag: member="ArmV8KvmCPU::miscRegMap" ref="a2ad7971fa046d7bb623529fa481bc065" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="structArmV8KvmCPU_1_1MiscRegInfo.html">ArmV8KvmCPU::MiscRegInfo</a> &gt; <a class="el" href="classArmV8KvmCPU.html#a2ad7971fa046d7bb623529fa481bc065">ArmV8KvmCPU::miscRegMap</a><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Initial value:</b><div class="fragment"><pre class="fragment"> {
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(regs.pstate), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919ca1d2df46d160cfa336591aaebdd6f99ba">MISCREG_CPSR</a>, <span class="stringliteral">&quot;PSTATE&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(elr_el1), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919ca23432fcb06b63bbbdf0f10bae2d73748">MISCREG_ELR_EL1</a>, <span class="stringliteral">&quot;ELR(EL1)&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(spsr[KVM_SPSR_EL1]), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919cabf77dd155ddd1020a03a9f11e2c44803">MISCREG_SPSR_EL1</a>, <span class="stringliteral">&quot;SPSR(EL1)&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(spsr[KVM_SPSR_ABT]), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919ca7ac1b2166841b17fab9db5286276a3fe">MISCREG_SPSR_ABT</a>, <span class="stringliteral">&quot;SPSR(ABT)&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(spsr[KVM_SPSR_UND]), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919ca0cddb533c7dccbe89da87203c21f5cc7">MISCREG_SPSR_UND</a>, <span class="stringliteral">&quot;SPSR(UND)&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(spsr[KVM_SPSR_IRQ]), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919ca5882c3c544025702f76f0045efa5ec31">MISCREG_SPSR_IRQ</a>, <span class="stringliteral">&quot;SPSR(IRQ)&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(spsr[KVM_SPSR_FIQ]), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919cad3cdb1317a25175044b454f01a85e080">MISCREG_SPSR_FIQ</a>, <span class="stringliteral">&quot;SPSR(FIQ)&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(fp_regs.fpsr), <a class="code" href="namespaceArmISA.html#a95c4749b8e05d58cf7536163a9ce919ca41f3fa5f2b85d9748ee5d4264f67d6c3">MISCREG_FPSR</a>, <span class="stringliteral">&quot;FPSR&quot;</span>),
    <a class="code" href="namespaceArmISA.html#acbfe4414fa174a85a2473fcdcd7b829a">MiscRegInfo</a>(<a class="code" href="armv8__cpu_8cc.html#a78e1645eccd2b066593c9ee03c31d0fc">INT_REG</a>(fp_regs.fpcr), <a class="code" href="namespaceAlphaISA.html#ad058b0990dcb8ed4d0b373396689fa12a5a65f564d02ab04f88a6ace6cee20a6c">MISCREG_FPCR</a>, <span class="stringliteral">&quot;FPCR&quot;</span>),
}
</pre></div>
<p>Mapping between gem5 misc registers registers and registers in kvm. </p>

<p>Definition at line <a class="el" href="armv8__cpu_8hh_source.html#l00134">134</a> of file <a class="el" href="armv8__cpu_8hh_source.html">armv8_cpu.hh</a>.</p>

<p>Referenced by <a class="el" href="armv8__cpu_8cc_source.html#l00126">dump()</a>, <a class="el" href="armv8__cpu_8cc_source.html#l00188">updateKvmState()</a>, and <a class="el" href="armv8__cpu_8cc_source.html#l00230">updateThreadContext()</a>.</p>

</div>
</div>
<a class="anchor" id="a43da0e4a006bce52aa054bacea2b4242"></a><!-- doxytag: member="ArmV8KvmCPU::sysRegMap" ref="a43da0e4a006bce52aa054bacea2b4242" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="structArmV8KvmCPU_1_1MiscRegInfo.html">ArmV8KvmCPU::MiscRegInfo</a>&gt; <a class="el" href="classArmV8KvmCPU.html#a43da0e4a006bce52aa054bacea2b4242">ArmV8KvmCPU::sysRegMap</a><code> [mutable, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cached mapping between system registers in kvm and misc regs in gem5. </p>

<p>Definition at line <a class="el" href="armv8__cpu_8hh_source.html#l00137">137</a> of file <a class="el" href="armv8__cpu_8hh_source.html">armv8_cpu.hh</a>.</p>

<p>Referenced by <a class="el" href="armv8__cpu_8cc_source.html#l00283">getSysRegMap()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>arch/arm/kvm/<a class="el" href="armv8__cpu_8hh_source.html">armv8_cpu.hh</a></li>
<li>arch/arm/kvm/<a class="el" href="armv8__cpu_8cc_source.html">armv8_cpu.cc</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"><address style="align: right;"><small>
Generated on Mon Dec 7 02:33:15 2015 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.6.1</small></address>

</body>
</html>
