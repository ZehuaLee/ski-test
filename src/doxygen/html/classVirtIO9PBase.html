<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gem5: VirtIO9PBase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>VirtIO9PBase Class Reference</h1><!-- doxytag: class="VirtIO9PBase" --><!-- doxytag: inherits="VirtIODeviceBase" -->
<p>This class implements a VirtIO transport layer for the 9p network file system.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for VirtIO9PBase:</div>
<div class="dynsection">
 <div class="center">
  <img src="classVirtIO9PBase.gif" usemap="#VirtIO9PBase_map" alt=""/>
  <map id="VirtIO9PBase_map" name="VirtIO9PBase_map">
<area href="classVirtIODeviceBase.html" alt="VirtIODeviceBase" shape="rect" coords="123,112,236,136"/>
<area href="classSimObject.html" alt="SimObject" shape="rect" coords="123,56,236,80"/>
<area href="classEventManager.html" alt="EventManager" shape="rect" coords="0,0,113,24"/>
<area href="classSerializable.html" alt="Serializable" shape="rect" coords="123,0,236,24"/>
<area href="classDrainable.html" alt="Drainable" shape="rect" coords="246,0,359,24"/>
<area href="classVirtIO9PProxy.html" alt="VirtIO9PProxy" shape="rect" coords="123,224,236,248"/>
<area href="classVirtIO9PDiod.html" alt="VirtIO9PDiod" shape="rect" coords="61,280,174,304"/>
<area href="classVirtIO9PSocket.html" alt="VirtIO9PSocket" shape="rect" coords="184,280,297,304"/>
</map>
 </div>
</div>

<p><a href="classVirtIO9PBase-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structVirtIO9PBase_1_1Config.html">Config</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">VirtIO 9p configuration structure.  <a href="structVirtIO9PBase_1_1Config.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase_1_1FSQueue.html">FSQueue</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Virtqueue for 9p requests.  <a href="classVirtIO9PBase_1_1FSQueue.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef VirtIO9PBaseParams&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a98e2dc24df546facf07246691816256f">Params</a></td></tr>
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a1fca2c7f72682d52a7d3550b07ee0c76">VirtIO9PBase</a> (<a class="el" href="classVirtIO9PBase.html#a98e2dc24df546facf07246691816256f">Params</a> *params)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a810927daec9673b6d9e3d76fd2b35050">~VirtIO9PBase</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#acebc495be1ef00d1526d1e3d5593dfdf">readConfig</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> cfgOffset)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read from the configuration space of a device.  <a href="#acebc495be1ef00d1526d1e3d5593dfdf"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#aaca7e7467155586a3b7f046bdd1b497c">recvTMsg</a> (const <a class="el" href="structP9MsgHeader.html">P9MsgHeader</a> &amp;header, const uint8_t *data, size_t size)=0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle incoming 9p RPC message.  <a href="#aaca7e7467155586a3b7f046bdd1b497c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a02fcb01c2f719118c2f9a0c54d085a0c">sendRMsg</a> (const <a class="el" href="structP9MsgHeader.html">P9MsgHeader</a> &amp;header, const uint8_t *data, size_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Send a 9p RPC message reply.  <a href="#a02fcb01c2f719118c2f9a0c54d085a0c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a451799371268c53792c0635a6ef509b4">dumpMsg</a> (const <a class="el" href="structP9MsgHeader.html">P9MsgHeader</a> &amp;header, const uint8_t *data, size_t size)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump a 9p RPC message on the debug output.  <a href="#a451799371268c53792c0635a6ef509b4"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structVirtIO9PBase_1_1Config.html">VirtIO9PBase::Config</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a28450f4ef5855c253f0989a1ea646da5">M5_ATTR_PACKED</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">VirtIO 9p configuration structure.  <a href="#a28450f4ef5855c253f0989a1ea646da5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="structVirtIO9PBase_1_1Config.html">Config</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#ae702cedd14dd4ce3d05ef41d32e573fa">config</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Currently active configuration (host byte order).  <a href="#ae702cedd14dd4ce3d05ef41d32e573fa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classVirtIO9PBase_1_1FSQueue.html">FSQueue</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a174405bd3189bc024e6d6510d5f4cc8c">queue</a></td></tr>
<tr><td colspan="2"><h2>Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classVirtIODeviceBase.html#a1b22ed10b4e720755cb018308f9f6334">DeviceId</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#aaa380f737f83e8a3bbecdeac7390b121">ID_9P</a> = 0x09</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">VirtIO device ID.  <a href="#aaa380f737f83e8a3bbecdeac7390b121"></a><br/></td></tr>
<tr><td colspan="2"><div class="groupHeader">Feature bits</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrp35986b401111bddc419810da604e44bd"></a> </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="classVirtIODeviceBase.html#a7e1d97e8524192841f59e900860e3855">FeatureBits</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a4793fa1c773055fb1ef23cd4432354d5">F_MOUNT_TAG</a> = 0x01</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Device provides a name of the resource in its configuration.  <a href="#a4793fa1c773055fb1ef23cd4432354d5"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="fs9p_8hh.html#aefad07c862d63625054c398e3d7de00e">P9Tag</a>, <a class="el" href="classVirtDescriptor.html">VirtDescriptor</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classVirtIO9PBase.html#a34ac247437043b4b25c742f4d7b60511">pendingTransactions</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Map between 9p transaction tags and descriptors where they appeared.  <a href="#a34ac247437043b4b25c742f4d7b60511"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This class implements a VirtIO transport layer for the 9p network file system. </p>
<p>The 9p VirtIO transport uses the following queues:</p>
<ol type="1">
<li>9p requests and replies</li>
</ol>
<p>Each 9p request and response is sent in its own descriptor chain. The guest initiates a transaction by packing a T message (see the 9p spec) into the first part of a descriptor chain. After the T message, the guest reserves space for the reply (R message) by including one or more writable descriptors. The server replies by writing an R message into the writable descriptors and putting the chain in the used ring (<a class="el" href="classVirtQueue.html#a5aa96983ba9571f6c9b3a8f57dd1d8bb" title="Send a descriptor chain to the guest.">VirtQueue::produceDescriptor()</a>).</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="https://github.com/rustyrussell/virtio-spec">https://github.com/rustyrussell/virtio-spec</a> </dd>
<dd>
<a href="https://github.com/ericvh/9p-rfc">https://github.com/ericvh/9p-rfc</a> </dd>
<dd>
<a href="https://code.google.com/p/diod/wiki/protocol">https://code.google.com/p/diod/wiki/protocol</a> </dd></dl>

<p>Definition at line <a class="el" href="fs9p_8hh_source.html#l00109">109</a> of file <a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>.</p>
<hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a98e2dc24df546facf07246691816256f"></a><!-- doxytag: member="VirtIO9PBase::Params" ref="a98e2dc24df546facf07246691816256f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef VirtIO9PBaseParams <a class="el" href="classVirtIO9PBase.html#a98e2dc24df546facf07246691816256f">VirtIO9PBase::Params</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classSimObject.html#a5ec10f06fd6e6061713b405aa822ae51">SimObject</a>.</p>

<p>Reimplemented in <a class="el" href="classVirtIO9PProxy.html#a8cf2dafdfd7cbd94037e0db108697ccd">VirtIO9PProxy</a>, <a class="el" href="classVirtIO9PDiod.html#a309546a61ae2d60eea20b10a2b90bf02">VirtIO9PDiod</a>, and <a class="el" href="classVirtIO9PSocket.html#a73ae6164c6721a3ba49b4d48acada68d">VirtIO9PSocket</a>.</p>

<p>Definition at line <a class="el" href="fs9p_8hh_source.html#l00112">112</a> of file <a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>.</p>

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a1fca2c7f72682d52a7d3550b07ee0c76"></a><!-- doxytag: member="VirtIO9PBase::VirtIO9PBase" ref="a1fca2c7f72682d52a7d3550b07ee0c76" args="(Params *params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VirtIO9PBase::VirtIO9PBase </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVirtIO9PBase.html#a98e2dc24df546facf07246691816256f">Params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fs9p_8cc_source.html#l00109">109</a> of file <a class="el" href="fs9p_8cc_source.html">fs9p.cc</a>.</p>

<p>References <a class="el" href="fs9p_8hh_source.html#l00131">config</a>, <a class="el" href="dev_2virtio_2base_8hh_source.html#l00851">VirtIODeviceBase::configSize</a>, <a class="el" href="dev_2virtio_2base_8hh_source.html#l00074">htov_legacy()</a>, <a class="el" href="fs9p_8hh_source.html#l00162">queue</a>, and <a class="el" href="dev_2virtio_2base_8cc_source.html#l00479">VirtIODeviceBase::registerQueue()</a>.</p>

</div>
</div>
<a class="anchor" id="a810927daec9673b6d9e3d76fd2b35050"></a><!-- doxytag: member="VirtIO9PBase::~VirtIO9PBase" ref="a810927daec9673b6d9e3d76fd2b35050" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VirtIO9PBase::~VirtIO9PBase </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fs9p_8cc_source.html#l00124">124</a> of file <a class="el" href="fs9p_8cc_source.html">fs9p.cc</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a451799371268c53792c0635a6ef509b4"></a><!-- doxytag: member="VirtIO9PBase::dumpMsg" ref="a451799371268c53792c0635a6ef509b4" args="(const P9MsgHeader &amp;header, const uint8_t *data, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VirtIO9PBase::dumpMsg </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structP9MsgHeader.html">P9MsgHeader</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dump a 9p RPC message on the debug output. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>header</em>&nbsp;</td><td>9p message header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Pointer to data in message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Size of data (excluding header) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fs9p_8cc_source.html#l00186">186</a> of file <a class="el" href="fs9p_8cc_source.html">fs9p.cc</a>.</p>

<p>References <a class="el" href="base_2trace_8hh_source.html#l00210">DDUMP</a>, <a class="el" href="base_2trace_8hh_source.html#l00211">DPRINTF</a>, <a class="el" href="base_2trace_8hh_source.html#l00209">DTRACE</a>, <a class="el" href="fs9p_8hh_source.html#l00057">P9MsgHeader::len</a>, <a class="el" href="fs9p_8cc_source.html#l00061">P9MsgInfo::name</a>, <a class="el" href="fs9p_8hh_source.html#l00061">P9MsgHeader::tag</a>, and <a class="el" href="fs9p_8hh_source.html#l00059">P9MsgHeader::type</a>.</p>

<p>Referenced by <a class="el" href="fs9p_8cc_source.html#l00135">VirtIO9PBase::FSQueue::onNotifyDescriptor()</a>, and <a class="el" href="fs9p_8cc_source.html#l00158">sendRMsg()</a>.</p>

</div>
</div>
<a class="anchor" id="acebc495be1ef00d1526d1e3d5593dfdf"></a><!-- doxytag: member="VirtIO9PBase::readConfig" ref="acebc495be1ef00d1526d1e3d5593dfdf" args="(PacketPtr pkt, Addr cfgOffset)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VirtIO9PBase::readConfig </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>cfgOffset</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read from the configuration space of a device. </p>
<p>This method is called by the transport interface to read data from a device model's configuration space. The device model should use the cfgOffset parameter as the offset into its configuration space.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>The address in the packet should not be used to determine the offset into a device's configuration space.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>Read request packet. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cfgOffset</em>&nbsp;</td><td>Offset into the device's configuration space. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classVirtIODeviceBase.html#a67726d16881dc7542fb4466b70a79f0f">VirtIODeviceBase</a>.</p>

<p>Definition at line <a class="el" href="fs9p_8cc_source.html#l00129">129</a> of file <a class="el" href="fs9p_8cc_source.html">fs9p.cc</a>.</p>

<p>References <a class="el" href="fs9p_8hh_source.html#l00131">config</a>, and <a class="el" href="dev_2virtio_2base_8cc_source.html#l00422">VirtIODeviceBase::readConfigBlob()</a>.</p>

</div>
</div>
<a class="anchor" id="aaca7e7467155586a3b7f046bdd1b497c"></a><!-- doxytag: member="VirtIO9PBase::recvTMsg" ref="aaca7e7467155586a3b7f046bdd1b497c" args="(const P9MsgHeader &amp;header, const uint8_t *data, size_t size)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void VirtIO9PBase::recvTMsg </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structP9MsgHeader.html">P9MsgHeader</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle incoming 9p RPC message. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>header</em>&nbsp;</td><td>9p message header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Pointer to data in message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Size of data (excluding header) </td></tr>
  </table>
  </dd>
</dl>

<p>Implemented in <a class="el" href="classVirtIO9PProxy.html#aa39e9ef23d89886bd74d369f48979471">VirtIO9PProxy</a>.</p>

<p>Referenced by <a class="el" href="fs9p_8cc_source.html#l00135">VirtIO9PBase::FSQueue::onNotifyDescriptor()</a>.</p>

</div>
</div>
<a class="anchor" id="a02fcb01c2f719118c2f9a0c54d085a0c"></a><!-- doxytag: member="VirtIO9PBase::sendRMsg" ref="a02fcb01c2f719118c2f9a0c54d085a0c" args="(const P9MsgHeader &amp;header, const uint8_t *data, size_t size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VirtIO9PBase::sendRMsg </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structP9MsgHeader.html">P9MsgHeader</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>size</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Send a 9p RPC message reply. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>header</em>&nbsp;</td><td>9p message header. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>Pointer to data in message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>Size of data (excluding header) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="fs9p_8cc_source.html#l00158">158</a> of file <a class="el" href="fs9p_8cc_source.html">fs9p.cc</a>.</p>

<p>References <a class="el" href="classVirtDescriptor.html#a6240118e99f82d6afc18b03667e3143a">VirtDescriptor::chainWrite()</a>, <a class="el" href="base_2trace_8hh_source.html#l00211">DPRINTF</a>, <a class="el" href="fs9p_8cc_source.html#l00186">dumpMsg()</a>, <a class="el" href="fs9p_8hh_source.html#l00070">htop9()</a>, <a class="el" href="dev_2virtio_2base_8hh_source.html#l00248">VirtDescriptor::isOutgoing()</a>, <a class="el" href="dev_2virtio_2base_8hh_source.html#l00621">VirtIODeviceBase::kick()</a>, <a class="el" href="fs9p_8hh_source.html#l00057">P9MsgHeader::len</a>, <a class="el" href="classVirtDescriptor.html#a8128579aaad158dc54ca3e82de38a85a">VirtDescriptor::next()</a>, <a class="el" href="base_2misc_8hh_source.html#l00104">panic</a>, <a class="el" href="fs9p_8hh_source.html#l00201">pendingTransactions</a>, <a class="el" href="dev_2virtio_2base_8cc_source.html#l00288">VirtQueue::produceDescriptor()</a>, <a class="el" href="fs9p_8hh_source.html#l00162">queue</a>, and <a class="el" href="fs9p_8hh_source.html#l00061">P9MsgHeader::tag</a>.</p>

<p>Referenced by <a class="el" href="fs9p_8cc_source.html#l00244">VirtIO9PProxy::serverDataReady()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ae702cedd14dd4ce3d05ef41d32e573fa"></a><!-- doxytag: member="VirtIO9PBase::config" ref="ae702cedd14dd4ce3d05ef41d32e573fa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="structVirtIO9PBase_1_1Config.html">Config</a>&gt; <a class="el" href="classVirtIO9PBase.html#ae702cedd14dd4ce3d05ef41d32e573fa">VirtIO9PBase::config</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Currently active configuration (host byte order). </p>

<p>Definition at line <a class="el" href="fs9p_8hh_source.html#l00131">131</a> of file <a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>.</p>

<p>Referenced by <a class="el" href="fs9p_8cc_source.html#l00129">readConfig()</a>, and <a class="el" href="fs9p_8cc_source.html#l00109">VirtIO9PBase()</a>.</p>

</div>
</div>
<a class="anchor" id="a4793fa1c773055fb1ef23cd4432354d5"></a><!-- doxytag: member="VirtIO9PBase::F_MOUNT_TAG" ref="a4793fa1c773055fb1ef23cd4432354d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classVirtIODeviceBase.html#a7e1d97e8524192841f59e900860e3855">FeatureBits</a> <a class="el" href="classVirtIO9PBase.html#a4793fa1c773055fb1ef23cd4432354d5">VirtIO9PBase::F_MOUNT_TAG</a> = 0x01<code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Device provides a name of the resource in its configuration. </p>

<p>Definition at line <a class="el" href="fs9p_8hh_source.html#l00140">140</a> of file <a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>.</p>

</div>
</div>
<a class="anchor" id="aaa380f737f83e8a3bbecdeac7390b121"></a><!-- doxytag: member="VirtIO9PBase::ID_9P" ref="aaa380f737f83e8a3bbecdeac7390b121" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classVirtIODeviceBase.html#a1b22ed10b4e720755cb018308f9f6334">DeviceId</a> <a class="el" href="classVirtIO9PBase.html#aaa380f737f83e8a3bbecdeac7390b121">VirtIO9PBase::ID_9P</a> = 0x09<code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>VirtIO device ID. </p>

<p>Definition at line <a class="el" href="fs9p_8hh_source.html#l00134">134</a> of file <a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>.</p>

</div>
</div>
<a class="anchor" id="a28450f4ef5855c253f0989a1ea646da5"></a><!-- doxytag: member="VirtIO9PBase::M5_ATTR_PACKED" ref="a28450f4ef5855c253f0989a1ea646da5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structVirtIO9PBase_1_1Config.html">VirtIO9PBase::Config</a>  <a class="el" href="classVirtIO9PBase.html#a28450f4ef5855c253f0989a1ea646da5">VirtIO9PBase::M5_ATTR_PACKED</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>VirtIO 9p configuration structure. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>The fields in this structure depend on the features exposed to the guest. </dd></dl>

</div>
</div>
<a class="anchor" id="a34ac247437043b4b25c742f4d7b60511"></a><!-- doxytag: member="VirtIO9PBase::pendingTransactions" ref="a34ac247437043b4b25c742f4d7b60511" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="fs9p_8hh.html#aefad07c862d63625054c398e3d7de00e">P9Tag</a>, <a class="el" href="classVirtDescriptor.html">VirtDescriptor</a> *&gt; <a class="el" href="classVirtIO9PBase.html#a34ac247437043b4b25c742f4d7b60511">VirtIO9PBase::pendingTransactions</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Map between 9p transaction tags and descriptors where they appeared. </p>
<p>When handling asynchronous requests, we need to ensure that replies are posted in the same descriptor as queries. The 9p RPC protocol uses the tag field in the header to match requests and replies, which we use here to find the relevant descriptor. </p>

<p>Definition at line <a class="el" href="fs9p_8hh_source.html#l00201">201</a> of file <a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>.</p>

<p>Referenced by <a class="el" href="fs9p_8cc_source.html#l00135">VirtIO9PBase::FSQueue::onNotifyDescriptor()</a>, and <a class="el" href="fs9p_8cc_source.html#l00158">sendRMsg()</a>.</p>

</div>
</div>
<a class="anchor" id="a174405bd3189bc024e6d6510d5f4cc8c"></a><!-- doxytag: member="VirtIO9PBase::queue" ref="a174405bd3189bc024e6d6510d5f4cc8c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classVirtIO9PBase_1_1FSQueue.html">FSQueue</a> <a class="el" href="classVirtIO9PBase.html#a174405bd3189bc024e6d6510d5f4cc8c">VirtIO9PBase::queue</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="fs9p_8hh_source.html#l00162">162</a> of file <a class="el" href="fs9p_8hh_source.html">fs9p.hh</a>.</p>

<p>Referenced by <a class="el" href="fs9p_8cc_source.html#l00158">sendRMsg()</a>, and <a class="el" href="fs9p_8cc_source.html#l00109">VirtIO9PBase()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>dev/virtio/<a class="el" href="fs9p_8hh_source.html">fs9p.hh</a></li>
<li>dev/virtio/<a class="el" href="fs9p_8cc_source.html">fs9p.cc</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"><address style="align: right;"><small>
Generated on Mon Dec 7 02:33:23 2015 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.6.1</small></address>

</body>
</html>
