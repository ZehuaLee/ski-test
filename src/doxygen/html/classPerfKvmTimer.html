<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gem5: PerfKvmTimer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>PerfKvmTimer Class Reference</h1><!-- doxytag: class="PerfKvmTimer" --><!-- doxytag: inherits="BaseKvmTimer" -->
<p>PerfEvent based timer using the host's CPU cycle counter.  
<a href="#_details">More...</a></p>

<p><code>#include &lt;<a class="el" href="timer_8hh_source.html">timer.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for PerfKvmTimer:</div>
<div class="dynsection">
 <div class="center">
  <img src="classPerfKvmTimer.gif" usemap="#PerfKvmTimer_map" alt=""/>
  <map id="PerfKvmTimer_map" name="PerfKvmTimer_map">
<area href="classBaseKvmTimer.html" alt="BaseKvmTimer" shape="rect" coords="0,0,95,24"/>
</map>
 </div>
</div>

<p><a href="classPerfKvmTimer-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPerfKvmTimer.html#a4b2c698eb0eec20f3bc953dc62265e70">PerfKvmTimer</a> (<a class="el" href="classPerfKvmCounter.html">PerfKvmCounter</a> &amp;ctr, int <a class="el" href="classBaseKvmTimer.html#a68a12b576cb2937b4824aecf44207012">signo</a>, float <a class="el" href="classBaseKvmTimer.html#aa6e7c5319a3c9d089739b0eab79b9cf5">hostFactor</a>, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classBaseKvmTimer.html#a365cf18ff970e93c6eec07d42216daae">hostFreq</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a timer that uses an existing hardware cycle counter.  <a href="#a4b2c698eb0eec20f3bc953dc62265e70"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPerfKvmTimer.html#a714695e21aed0df089ad9cccec43c935">~PerfKvmTimer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPerfKvmTimer.html#abf1e6acdbc4e32d35fedb178405c9988">arm</a> (<a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> ticks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Arm the timer so that it fires after a certain number of ticks.  <a href="#abf1e6acdbc4e32d35fedb178405c9988"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPerfKvmTimer.html#a2398ac400bf11cda20005f2f150475ab">disarm</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disarm the timer.  <a href="#a2398ac400bf11cda20005f2f150475ab"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPerfKvmTimer.html#acbb1bd72ab6e6b509137d21aa61ec616">calcResolution</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the timer resolution, used by <a class="el" href="classBaseKvmTimer.html#a79a9f4d9d2bc3cbdd4af33c8ae4bc0f7" title="Determine the resolution of the timer in ticks.">resolution()</a> which caches the result.  <a href="#acbb1bd72ab6e6b509137d21aa61ec616"></a><br/></td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPerfKvmCounter.html">PerfKvmCounter</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPerfKvmTimer.html#a70d08dedcc6fd201a12423c21cd2a3a2">hwOverflow</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>PerfEvent based timer using the host's CPU cycle counter. </p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>There is a known problem in some versions of the PerfEvent API that prevents the counter overflow period from being updated reliably, which might break this timer. See <a class="el" href="classPerfKvmCounter.html#a783736987df878785e0e9de13f1b996b" title="Update the period of an overflow counter.">PerfKvmCounter::period()</a> for details. </dd></dl>

<p>Definition at line <a class="el" href="timer_8hh_source.html#l00215">215</a> of file <a class="el" href="timer_8hh_source.html">timer.hh</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a4b2c698eb0eec20f3bc953dc62265e70"></a><!-- doxytag: member="PerfKvmTimer::PerfKvmTimer" ref="a4b2c698eb0eec20f3bc953dc62265e70" args="(PerfKvmCounter &amp;ctr, int signo, float hostFactor, Tick hostFreq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PerfKvmTimer::PerfKvmTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPerfKvmCounter.html">PerfKvmCounter</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>ctr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>signo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>hostFactor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>hostFreq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a timer that uses an existing hardware cycle counter. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>The performance counter must be configured for overflow sampling, which in practice means that it must have a non-zero sample period. The initial sample period is ignored since period will be updated when <a class="el" href="classPerfKvmTimer.html#abf1e6acdbc4e32d35fedb178405c9988" title="Arm the timer so that it fires after a certain number of ticks.">arm()</a> is called.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ctr</em>&nbsp;</td><td>Attached performance counter configured for overflow reporting. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>signo</em>&nbsp;</td><td>Signal to deliver </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hostFactor</em>&nbsp;</td><td>Performance scaling factor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hostFreq</em>&nbsp;</td><td>Clock frequency of the host </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="timer_8cc_source.html#l00159">159</a> of file <a class="el" href="timer_8cc_source.html">timer.cc</a>.</p>

<p>References <a class="el" href="perfevent_8cc_source.html#l00146">PerfKvmCounter::enableSignals()</a>, and <a class="el" href="timer_8hh_source.html#l00244">hwOverflow</a>.</p>

</div>
</div>
<a class="anchor" id="a714695e21aed0df089ad9cccec43c935"></a><!-- doxytag: member="PerfKvmTimer::~PerfKvmTimer" ref="a714695e21aed0df089ad9cccec43c935" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PerfKvmTimer::~PerfKvmTimer </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="timer_8cc_source.html#l00167">167</a> of file <a class="el" href="timer_8cc_source.html">timer.cc</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="abf1e6acdbc4e32d35fedb178405c9988"></a><!-- doxytag: member="PerfKvmTimer::arm" ref="abf1e6acdbc4e32d35fedb178405c9988" args="(Tick ticks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PerfKvmTimer::arm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>ticks</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Arm the timer so that it fires after a certain number of ticks. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>A timer implementation is free to convert between simulation ticks and virtualized time using any method it chooses. The accuracy of the timer therefore depends on what it measures, an accurate timer implementation should measure the number of cycles or instructions executed in the guest. If such counters are unavailable, it may fallback to wall clock time.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ticks</em>&nbsp;</td><td>Number of ticks until the timer fires </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classBaseKvmTimer.html#af791d30c62301e0f2bb64b742b2becbd">BaseKvmTimer</a>.</p>

<p>Definition at line <a class="el" href="timer_8cc_source.html#l00172">172</a> of file <a class="el" href="timer_8cc_source.html">timer.cc</a>.</p>

<p>References <a class="el" href="timer_8hh_source.html#l00158">BaseKvmTimer::hostCycles()</a>, <a class="el" href="timer_8hh_source.html#l00244">hwOverflow</a>, <a class="el" href="perfevent_8cc_source.html#l00123">PerfKvmCounter::period()</a>, and <a class="el" href="perfevent_8cc_source.html#l00130">PerfKvmCounter::refresh()</a>.</p>

</div>
</div>
<a class="anchor" id="acbb1bd72ab6e6b509137d21aa61ec616"></a><!-- doxytag: member="PerfKvmTimer::calcResolution" ref="acbb1bd72ab6e6b509137d21aa61ec616" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> PerfKvmTimer::calcResolution </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the timer resolution, used by <a class="el" href="classBaseKvmTimer.html#a79a9f4d9d2bc3cbdd4af33c8ae4bc0f7" title="Determine the resolution of the timer in ticks.">resolution()</a> which caches the result. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Minimum number of ticks the timer can resolve </dd></dl>

<p>Implements <a class="el" href="classBaseKvmTimer.html#a5cec09f97d6148d8648129ec609b27ed">BaseKvmTimer</a>.</p>

<p>Definition at line <a class="el" href="timer_8cc_source.html#l00185">185</a> of file <a class="el" href="timer_8cc_source.html">timer.cc</a>.</p>

<p>References <a class="el" href="timer_8cc_source.html#l00074">MIN_HOST_CYCLES</a>, and <a class="el" href="timer_8hh_source.html#l00119">BaseKvmTimer::ticksFromHostCycles()</a>.</p>

</div>
</div>
<a class="anchor" id="a2398ac400bf11cda20005f2f150475ab"></a><!-- doxytag: member="PerfKvmTimer::disarm" ref="a2398ac400bf11cda20005f2f150475ab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PerfKvmTimer::disarm </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disarm the timer. </p>
<p>When this method has returned, the timer may no longer deliver signals upon timeout. </p>

<p>Implements <a class="el" href="classBaseKvmTimer.html#a17687d3e409ee964c562abe4d897e312">BaseKvmTimer</a>.</p>

<p>Definition at line <a class="el" href="timer_8cc_source.html#l00179">179</a> of file <a class="el" href="timer_8cc_source.html">timer.cc</a>.</p>

<p>References <a class="el" href="timer_8hh_source.html#l00244">hwOverflow</a>, and <a class="el" href="perfevent_8cc_source.html#l00116">PerfKvmCounter::stop()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a70d08dedcc6fd201a12423c21cd2a3a2"></a><!-- doxytag: member="PerfKvmTimer::hwOverflow" ref="a70d08dedcc6fd201a12423c21cd2a3a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPerfKvmCounter.html">PerfKvmCounter</a>&amp; <a class="el" href="classPerfKvmTimer.html#a70d08dedcc6fd201a12423c21cd2a3a2">PerfKvmTimer::hwOverflow</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="timer_8hh_source.html#l00244">244</a> of file <a class="el" href="timer_8hh_source.html">timer.hh</a>.</p>

<p>Referenced by <a class="el" href="timer_8cc_source.html#l00172">arm()</a>, <a class="el" href="timer_8cc_source.html#l00179">disarm()</a>, and <a class="el" href="timer_8cc_source.html#l00159">PerfKvmTimer()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>cpu/kvm/<a class="el" href="timer_8hh_source.html">timer.hh</a></li>
<li>cpu/kvm/<a class="el" href="timer_8cc_source.html">timer.cc</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"><address style="align: right;"><small>
Generated on Mon Dec 7 02:33:21 2015 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.6.1</small></address>

</body>
</html>
